---
 xenserver/etc_init.d_openvswitch                           |    9 ++++++---
 xenserver/usr_share_openvswitch_scripts_sysconfig.template |    3 +++
 2 files changed, 9 insertions(+), 3 deletions(-)

diff -r 94801242ce6a xenserver/etc_init.d_openvswitch
--- a/xenserver/etc_init.d_openvswitch	Thu Feb 17 12:15:49 2011 +0000
+++ b/xenserver/etc_init.d_openvswitch	Thu Feb 17 12:25:04 2011 +0000
@@ -80,6 +80,7 @@
 esac
 
 : ${ENABLE_MONITOR:=y}
+: ${ENABLE_MONITOR_DAEMON:=n}
 : ${FORCE_COREFILES:=y}
 
 # Config variables specific to ovsdb-server
@@ -365,11 +366,13 @@
 
     start_vswitchd
 
-    if [ -f /etc/xensource-inventory ]; then
-        # Start daemon to monitor external ids
-        PYTHONPATH=/usr/share/openvswitch/python \
+    if [ "${ENABLE_MONITOR_DAEMON}" = "y" ] ; then
+        if [ -f /etc/xensource-inventory ]; then
+            # Start daemon to monitor external ids
+            PYTHONPATH=/usr/share/openvswitch/python \
                    /usr/share/openvswitch/scripts/ovs-xapi-sync \
                    --pidfile --detach $monitor_opt "$VSWITCHD_OVSDB_SERVER"
+        fi
     fi
 
     touch /var/lock/subsys/openvswitch
diff -r 94801242ce6a xenserver/usr_share_openvswitch_scripts_sysconfig.template
--- a/xenserver/usr_share_openvswitch_scripts_sysconfig.template	Thu Feb 17 12:15:49 2011 +0000
+++ b/xenserver/usr_share_openvswitch_scripts_sysconfig.template	Thu Feb 17 12:25:04 2011 +0000
@@ -10,6 +10,9 @@
 # ENABLE_MONITOR: If 'y' then monitor daemon processes and restart them
 #    if they die due to an error signal.
 # ENABLE_MONITOR=y
+
+# ENABLE_MONITOR_DAEMON: If 'y' then monitor daemon will be started.
+# ENABLE_MONITOR_DAEMON=n
 
 # FORCE_COREFILES: If 'y' then core files will be enabled.
 # FORCE_COREFILES=y
