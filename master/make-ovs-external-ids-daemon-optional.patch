---
 xenserver/etc_init.d_openvswitch                           |    9 ++++++---
 xenserver/usr_share_openvswitch_scripts_sysconfig.template |    3 +++
 2 files changed, 9 insertions(+), 3 deletions(-)

diff -r d913711ec5dd xenserver/etc_init.d_openvswitch
--- a/xenserver/etc_init.d_openvswitch	Tue Jan 25 13:02:31 2011 +0000
+++ b/xenserver/etc_init.d_openvswitch	Tue Jan 25 13:08:31 2011 +0000
@@ -95,6 +95,7 @@
     : ${ENABLE_FAKE_PROC_NET:=y}
 fi
 : ${ENABLE_MONITOR:=y}
+: ${ENABLE_MONITOR_DAEMON:=n}
 : ${FORCE_COREFILES:=y}
 
 # Config variables specific to ovsdb-server
@@ -427,10 +428,12 @@
     fi
 
     if [ -f /etc/xensource-inventory ]; then
-        # Start daemon to monitor external ids
-        PYTHONPATH=/usr/share/openvswitch/python \
-                   /usr/share/openvswitch/scripts/ovs-external-ids \
-                   --pidfile --detach $monitor_opt "$VSWITCHD_OVSDB_SERVER"
+        if [ "${ENABLE_MONITOR_DAEMON}" = "y" ] ; then
+            # Start daemon to monitor external ids
+            PYTHONPATH=/usr/share/openvswitch/python \
+                       /usr/share/openvswitch/scripts/ovs-external-ids \
+                       --pidfile --detach $monitor_opt "$VSWITCHD_OVSDB_SERVER"
+        fi
     fi
 
     touch /var/lock/subsys/openvswitch
diff -r d913711ec5dd xenserver/usr_share_openvswitch_scripts_sysconfig.template
--- a/xenserver/usr_share_openvswitch_scripts_sysconfig.template	Tue Jan 25 13:02:31 2011 +0000
+++ b/xenserver/usr_share_openvswitch_scripts_sysconfig.template	Tue Jan 25 13:08:31 2011 +0000
@@ -20,6 +20,9 @@
 #    This is required and enabled by default for XenServer 5.5.0,
 #    and not required and not enabled by default for later versions.
 # ENABLE_FAKE_PROC_NET=?
+
+# ENABLE_MONITOR_DAEMON: If 'y' then monitor daemon will be started.
+# ENABLE_MONITOR_DAEMON=n
 
 # ENABLE_MONITOR: If 'y' then monitor daemon processes and restart them
 #    if they die due to an error signal.
